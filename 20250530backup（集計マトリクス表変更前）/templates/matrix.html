{% extends "layout.html" %}
{% block content %}

<div class="matrix-page">

  <h2 style="margin-bottom:0;">ğŸ§  æ„Ÿæƒ… Ã— åˆ©ç›Šãƒãƒˆãƒªã‚¯ã‚¹</h2>

  <!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
  <div style="width:100%; max-width:1200px; margin:0 auto 1em auto; display:flex; justify-content:flex-end;">
    <form method="get" action="/matrix" style="display:flex; gap:4px; align-items:center;">
      <input type="text" name="q" placeholder="æ¤œç´¢" value="{{ request.args.get('q', '') }}" style="width: 140px;">
      <button type="submit">æ¤œç´¢</button>
      <button type="button" id="clear-btn">ã‚¯ãƒªã‚¢</button>
    </form>
  </div>

  <div class="matrix-wrapper">
  <table class="matrix-table">

  <!-- ãƒãƒˆãƒªã‚¯ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ« -->
  <table border="1" cellpadding="8" cellspacing="0" style="table-layout:fixed; width:100%;">
    <thead>
      <tr>
        <th>åˆ©ç›Š</th>
        <th>ã‚¨ãƒ³ãƒˆãƒªãƒ¼æ„Ÿæƒ…</th>
        <th>æ±ºæ¸ˆæ„Ÿæƒ…</th>
        <th>ä¿æœ‰æœŸé–“ï¼ˆæ—¥ï¼‰</th>
        <th>ğŸ“ ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ¡ãƒ¢</th>
        <th>ğŸ“ æ±ºæ¸ˆãƒ¡ãƒ¢</th>
        <th>è©³ç´°</th>
      </tr>
    </thead>
    <tbody>
      {% set feelings = ['', 'ğŸ˜– ãƒã‚¬ãƒ†ã‚£ãƒ–', 'ğŸ˜ ã‚„ã‚„ä¸å®‰', 'ğŸ˜ ãµã¤ã†', 'ğŸ™‚ ã¾ã‚ã¾ã‚', 'ğŸ˜„ ãƒãƒƒãƒ”ãƒ¼'] %}
      {% for row in results %}
        <tr>
          <td style="text-align:right;">{{ "{:+,}".format(row[0]|int) }} å††</td>
          <td><span class="feeling-{{ row[1] or 0 }}">{{ feelings[row[1] or 0] }}</span></td>
          <td><span class="feeling-{{ row[2] or 0 }}">{{ feelings[row[2] or 0] }}</span></td>
          <td style="text-align:right;">{{ row[3] if row[3] != "-" else "-" }}</td>
          <td>{{ row[4] or "&nbsp;" | safe }}</td>
          <td>{{ row[5] or "&nbsp;" | safe }}</td>
          <td>
            <a href="/history?id={{ row[6] }}" class="history-link">ğŸ”—è©³ç´°</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

    </table>
</div>




  <!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
  <div class="pagination" style="text-align:center; margin: 16px 0;">
    {% if page > 1 %}
      <a href="?page={{ page - 1 }}">Â« å‰ã¸</a>
    {% endif %}
    <span style="margin:0 8px;">{{ page }} / {{ total_pages }}</span>
    {% if page < total_pages %}
      <a href="?page={{ page + 1 }}">æ¬¡ã¸ Â»</a>
    {% endif %}
  </div>

</div> <!-- /.matrix-page -->


<!-- ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³å‹•ä½œ -->
<script>
  document.getElementById('clear-btn').onclick = function() {
    window.location.href = '/matrix';
  };
</script>

<!-- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒè¶³ã‚Šãªã„ã¨ãã«ä½™ç™½ã‚’è¿½åŠ  -->
<script>
  if (document.body.scrollHeight <= window.innerHeight) {
    const filler = document.createElement('div');
    filler.style.height = '200px';
    document.body.appendChild(filler);
  }
</script>




{% endblock %}
